

https://zhuanlan.zhihu.com/p/346479426
# 方法1：辗转相除法（欧几里得算法）

欧几里德算法又称辗转相除法，用于计算两个整数a,b的最大公约数。其计算原理依赖于下面的定理：

欧几里德算法的思想基于辗转相除法的原理
>（GCD递归定律）
>对于任意非负整数a和任意正整数b
 $gcd(a,b)=gcd(b,a\ mod (b))$

这里$a, b$的大小不影响后续迭代。
## 正确性
- 证1
令 $c$ 为 $a$ 和 $b$ 的最大公约数，表示为 $c=gcd(a,b)$ 。则存在两个数 $k_1,k_2$ 使得 $a=k_1\times c, b = k_2 \times c$ ，也可以记为$c|a, c|b$，即$a,b$都可以被$c$整除。
$r = a\ mod (b)$等价于存在整数$r,k_3$使得余数$r = a – k_3 \times b$
$$
\begin{align}
r &= a - k_3 \times b\\
&= k_1 \times c - k_3 \times k_2 \times c\\
&= (k_1 - k_3 \times k_2) \times c
\end{align}
$$
则，$c|r$，$r, a, b$有相同的公约数。

## 性能

通过模运算的余数是最大公约数之间存在的整数倍的关系，来给比较大的数字进行降维，方便手算；同时，也避免了在可行区间内进行全局的最大公约数的判断测试，只需要选取其余数进行相应的计算就可以直接得到最大公约数，大大提高了运算效率。

## 方法2：更相减损术

> 更相减损法：更相减损术， 出自于中国古代的《九章算术》，也是一种求最大公约数的算法。  
>   ①先判断两个数的大小，如果两数相等，则这个数本身就 是就是它的最大公约数。  
>   ②如果不相等，则用大数减去小数，然后用这个较小数与它们相减的结果相比较，如果相等，则这个差就是它们的最大公约数，而如果不相等，则继续执行②操作。

# 方法3：Stein算法（结合辗转相除法和更相减损法的优势以及移位运算）

移位运算的性能非常快。
根据：$gcd(kx, ky) = k\ gcd(x, y)$
对于给定的正整数a和b，不难得到如下的结论。其中gcb(a,b)的意思是求a,b的最大公约数的函数  

1. 当a和b均为偶数，gcd(a,b) = 2_gcd(a/2, b/2) = 2_gcd(a>>1, b>>1)
2. 当a为偶数，b为奇数，gcd(a,b) = gcd(a/2, b) = gcb(a>>1, b)
3. 当a为奇数，b为偶数，gcb(a,b) = gcb(a, b/2) = gcb(a, b>>1)
4. 当a和b均为奇数，利用更相减损术运算一次，gcb(a,b) = gcb(b, a-b)， 此时a-b的结果必然是偶数，又可以继续进行移位运算。