微架构剖析与设计

超标量 CPU 是实现指令级并行形式的 CPU，相比于标量 CPU，通过同时向不同执行单元分发多条指令来在同一时钟周期执行多条指令，在给定频率下获得更多吞吐率。超标量 CPU 中，指令分发器 Dispatcher 决定了那些指令可以并行运算并将指令分发到执行单元。超标量的概念在于 CPU 核由更多细粒度的执行单元组成，如算术逻辑单元、乘法器、浮点运算单元。

流水线将每条指令的执行分为多个阶段，允许在不同阶段同时执行不同的指令，增加了指令级并行 ILP。流水线技术要求执行的任务相同或相似，不同类型指令的格式和执行差异保持在最低限度，因此 RISC 非常适合流水线设计。经典的 RISC 流水线分为 5 级：Instruction Fetch, Instruction Decode, Execute, Memory Access, Write Back。
经典流水线的弊端在于指令执行不是并行的，由于流水线需要静态调度，也不允许指令 Speculative 执行。也就是说，一条指令需要从流水线前面的指令中收集结果，并且确认前面的指令执行无误后才能执行。流水线由于 Pipelining hazards 会 stall。一般有几种情况会停顿：
1. 数据冒险。
2. 控制冒险：由于分支指令对流水线重定向造成延迟。
3. 结构冒险：由于资源限制。
4. 内存访问延迟。
超流水线